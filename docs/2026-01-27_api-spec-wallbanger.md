# Kondate Loop APIä»•æ§˜æ›¸ä½œæˆ å£æ‰“ã¡ãƒ¡ãƒ¢

> ä½œæˆæ—¥: 2026-01-27
> ç›®çš„: å¥‘ç´„å‡çµã‚·ãƒ¼ãƒˆã®ã€ŒAPI/BEæœªæ¥ç¶šã€ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’åŸ‹ã‚ã€APIä»•æ§˜æ›¸ã‚’å®Œæˆã•ã›ã‚‹

---

## ç¾çŠ¶ã‚µãƒãƒªãƒ¼

### å®Œäº†æ¸ˆã¿ï¼ˆUIãƒ¢ãƒƒã‚¯ï¼‰
- çŒ®ç«‹è¡¨/ã‚»ãƒƒãƒˆé¸æŠ/å†·è”µåº«/è²·ã„ç‰©ãƒªã‚¹ãƒˆã®UI
- ãƒ¬ã‚·ãƒ”å¸³ï¼ˆãƒ¬ã‚·ãƒ”/ã‚»ãƒƒãƒˆã€ã‚«ãƒ†ã‚´ãƒªã€æ¤œç´¢/çµã‚Šè¾¼ã¿/ä¸¦ã³æ›¿ãˆï¼‰
- ãƒ¬ã‚·ãƒ”ã‚«ã‚¿ãƒ­ã‚°ï¼ˆè³¼å…¥/ä¿å­˜å°ç·šã€æ–™ç†å®¶ãƒšãƒ¼ã‚¸é·ç§»ï¼‰
- ãƒã‚¤ãƒšãƒ¼ã‚¸ï¼ˆãƒ—ãƒ©ãƒ³å¤‰æ›´/æ±ºæ¸ˆç¢ºèª/è³¼å…¥å±¥æ­´/ãƒ­ã‚°ã‚¢ã‚¦ãƒˆï¼‰
- èªè¨¼ï¼ˆå…¥å£/ãƒ­ã‚°ã‚¤ãƒ³/æ–°è¦ç™»éŒ²/ã‚¨ãƒ©ãƒ¼ï¼‰
- ãƒˆãƒ¼ã‚¹ãƒˆ/ãƒ¢ãƒ¼ãƒ€ãƒ«å‹•ä½œ

### API/BEæœªæ¥ç¶šï¼ˆä»Šå›åŸ‹ã‚ã‚‹ã¹ãé …ç›®ï¼‰
1. [ ] APIæ¥ç¶šï¼ˆç¾çŠ¶ãƒ¢ãƒƒã‚¯ï¼‰
2. [ ] è³¼å…¥/æ±ºæ¸ˆã®å®Ÿå‡¦ç†
3. [ ] æ–™ç†ãƒ­ã‚°/ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼ˆãƒ‡ãƒ¼ã‚¿é€£æºï¼‰
4. [ ] è¨ºæ–­ç”Ÿæˆ
5. [ ] ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—åŠ å…¥/æ±ºæ¸ˆ
6. [ ] ãƒ•ã‚©ãƒ­ãƒ¼/æ²ç¤ºæ¿/å¤–éƒ¨å…±æœ‰
7. [ ] **IDæ–¹å¼/ã‚¨ãƒ©ãƒ¼å½¢å¼/äººæ°—æŒ‡æ¨™ã®æœ€çµ‚ç¢ºå®š** â† æœ€åˆã«ã“ã“ã‚’æ±ºã‚ã‚‹

---

## å£æ‰“ã¡ãƒ­ã‚°

### 1. IDæ–¹å¼ã®ç¢ºå®š

**é¸æŠè‚¢:**
- UUID v4 - è¡çªç¢ºç‡ãŒä½ã„ã€ãƒ•ãƒ­ãƒ³ãƒˆã§ç”Ÿæˆå¯èƒ½
- ULID - ã‚½ãƒ¼ãƒˆå¯èƒ½ã€æ™‚åˆ»æƒ…å ±ã‚’å«ã‚€
- Snowflake - Twitter/Discordæ–¹å¼ã€é«˜é€Ÿç”Ÿæˆ
- Auto Increment - ã‚·ãƒ³ãƒ—ãƒ«ã€DBä¾å­˜

**ç¾çŠ¶ã®UIå‹å®šç¾©ï¼ˆsrc/types/api.tsï¼‰:**
- `id: string` ã§çµ±ä¸€ã•ã‚Œã¦ã„ã‚‹

**æ±ºå®šäº‹é …:**
- **ULID ã‚’æ¡ç”¨**
- ç†ç”±: DynamoDBã®Sort Keyã§æ™‚ç³»åˆ—ã‚½ãƒ¼ãƒˆãŒè‡ªç„¶ã«ã§ãã‚‹ã€URLãŒçŸ­ã„
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: èªè¨¼/èªå¯ã‚’ã—ã£ã‹ã‚Šå®Ÿè£…ã™ã‚Œã°å•é¡Œãªã—ï¼ˆIDæ–¹å¼ã§å®ˆã‚ã†ã¨ã—ãªã„ï¼‰
- Node.jsãƒ©ã‚¤ãƒ–ãƒ©ãƒª: `ulid` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨

---

### 2. ã‚¨ãƒ©ãƒ¼å½¢å¼ã®ç¢ºå®š

**å¥‘ç´„å‡çµã‚·ãƒ¼ãƒˆã®å®šç¾©:**
```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "å…¥åŠ›å†…å®¹ã«èª¤ã‚ŠãŒã‚ã‚Šã¾ã™",
    "details": [...]
  }
}
```

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰æ–¹é‡:**
- 400: Bad Requestï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ï¼‰
- 401: Unauthorizedï¼ˆèªè¨¼ã‚¨ãƒ©ãƒ¼ï¼‰
- 403: Forbiddenï¼ˆæ¨©é™ã‚¨ãƒ©ãƒ¼ï¼‰
- 404: Not Found
- 409: Conflictï¼ˆé‡è¤‡ãªã©ï¼‰
- 422: Unprocessable Entity
- 500: Internal Server Error

**æ±ºå®šäº‹é …:**
- HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: **400=å½¢å¼ã‚¨ãƒ©ãƒ¼ã€422=ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼**ï¼ˆRESTçš„ã«æ­£ã—ã„æ–¹å¼ï¼‰
- ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰å‘½å: **ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹å¤§æ–‡å­—**ï¼ˆä¾‹: `VALIDATION_ERROR`ï¼‰
- detailså½¢å¼:
```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "å…¥åŠ›å†…å®¹ã«èª¤ã‚ŠãŒã‚ã‚Šã¾ã™",
    "details": [
      { "field": "title", "message": "ã‚¿ã‚¤ãƒˆãƒ«ã¯å¿…é ˆã§ã™" }
    ]
  }
}
```

**ä¸»è¦ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä¸€è¦§:**
| ã‚³ãƒ¼ãƒ‰ | HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ç”¨é€” |
|--------|---------------|------|
| INVALID_REQUEST | 400 | JSONãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ç­‰ |
| UNAUTHORIZED | 401 | èªè¨¼ã‚¨ãƒ©ãƒ¼ |
| FORBIDDEN | 403 | æ¨©é™ã‚¨ãƒ©ãƒ¼ |
| NOT_FOUND | 404 | ãƒªã‚½ãƒ¼ã‚¹ãªã— |
| CONFLICT | 409 | é‡è¤‡ç™»éŒ² |
| VALIDATION_ERROR | 422 | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ |
| INTERNAL_ERROR | 500 | ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ |

---

### 3. äººæ°—æŒ‡æ¨™ã®ç¢ºå®š

**é¸æŠè‚¢:**
- ä¿å­˜æ•°ï¼ˆsavedCountï¼‰
- è³¼å…¥æ•°
- é–²è¦§æ•°
- è¤‡åˆæŒ‡æ¨™

**ç¾çŠ¶ã®ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿:**
- `savedCount` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå­˜åœ¨

**æ±ºå®šäº‹é …:**
- **MVP: ä¿å­˜æ•°ï¼ˆsavedCountï¼‰ã®ã¿ã§äººæ°—é †ã‚½ãƒ¼ãƒˆ**
- å°†æ¥çš„ã«ã¯é–²è¦§æ•°ï¼ˆviewCountï¼‰ã‚‚å–å¾—ã—ãŸã„ â†’ APIã‚¢ã‚¯ã‚»ã‚¹æ™‚ã®ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—å®Ÿè£…ã‚’å¾Œã§è¿½åŠ 
- çµã‚Šè¾¼ã¿æ¡ä»¶ã¨ã—ã¦ã®ä¿å­˜æ•°æ´»ç”¨ã¯å°†æ¥æ¤œè¨

---

## 4. APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè©³ç´°å®šç¾©

### 4-1. Planï¼ˆçŒ®ç«‹ï¼‰API

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ :**
- 1ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¤ãã€Œcurrentï¼ˆç¾åœ¨ï¼‰ã€ã¨ã€Œnextï¼ˆæ¬¡ï¼‰ã€ã®2æ 
- ã‚»ãƒƒãƒˆé©ç”¨æ™‚ã¯ç½®æ›

**PlanItem:**
```json
{
  "id": "01HNK...",
  "recipeId": "01HNJ...",
  "title": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
  "thumbnailUrl": "https://...",
  "isCooked": false,
  "cookedAt": null
}
```

---

#### GET /plan
ç¾åœ¨ã®çŒ®ç«‹ã‚’å–å¾—

**Response:**
```json
{
  "data": {
    "current": {
      "setId": "01HNJ...",
      "setTitle": "å¹³æ—¥5æ—¥ã‚†ã‚‹ã£ã¨ã‚»ãƒƒãƒˆ",
      "appliedAt": "2026-01-20T09:00:00Z",
      "items": [
        {
          "id": "01HNK...",
          "recipeId": "01HNJ...",
          "title": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
          "thumbnailUrl": "https://...",
          "isCooked": true,
          "cookedAt": "2026-01-21T19:30:00Z"
        }
      ]
    },
    "next": null
  }
}
```

---

#### POST /plan/select-set
ã‚»ãƒƒãƒˆã‚’çŒ®ç«‹ã«é©ç”¨

**Request:**
```json
{
  "setId": "01HNJ...",
  "slot": "current" | "next"
}
```

**Response:**
```json
{
  "data": {
    "slot": "current",
    "setId": "01HNJ...",
    "setTitle": "å¹³æ—¥5æ—¥ã‚†ã‚‹ã£ã¨ã‚»ãƒƒãƒˆ",
    "appliedAt": "2026-01-27T10:00:00Z",
    "items": [...]
  }
}
```

---

#### PATCH /plan/items/{id}
ã€Œä½œã£ãŸã€ãƒˆã‚°ãƒ«

**Request:**
```json
{ "isCooked": true }
```

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "isCooked": true,
    "cookedAt": "2026-01-27T19:30:00Z"
  }
}
```

â€» `isCooked: false` ã§å–ã‚Šæ¶ˆã—å¯èƒ½

---

### 4-2. Shoppingï¼ˆè²·ã„ç‰©ãƒªã‚¹ãƒˆï¼‰API

**è¨­è¨ˆæ–¹é‡:**
- è²·ã„ç‰©ãƒªã‚¹ãƒˆã¯çŒ®ç«‹ã«å¾“å±ï¼ˆçŒ®ç«‹å¤‰æ›´ã§è‡ªå‹•å†ç”Ÿæˆï¼‰
- **è²·ã„ç‰©ãƒªã‚¹ãƒˆè¡¨ç¤ºæ™‚ã«éƒ½åº¦ç”Ÿæˆ**ï¼ˆå†·è”µåº«ã®åœ¨åº«ã‚’å˜ä½ä¸€è‡´æ™‚ã®ã¿å·®ã—å¼•ãï¼‰
- åŒã˜é£Ÿæã¯åˆç®—ï¼ˆåŒä¸€åç§° + åŒä¸€å˜ä½ã®ã¿ï¼‰
- å˜ä½ãŒé•ã†å ´åˆã¯åˆ¥ã€…ã«è¡¨ç¤ºï¼ˆå˜ä½å¤‰æ›ã¯ã—ãªã„ï¼‰
- å˜ä½ä¸ä¸€è‡´ã®å†·è”µåº«é£Ÿæã¯ã€ŒğŸ  å†·è”µåº«ã«ã‚ã‚‹é£Ÿæã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«å‚è€ƒè¡¨ç¤º
- è²·ã„ç‰©å®Œäº† â†’ ãƒã‚§ãƒƒã‚¯æ¸ˆã¿ã¯å†·è”µåº«ã¸ã€æœªãƒã‚§ãƒƒã‚¯ã¯æ®‹ã‚‹

**å¸¸å‚™å“ï¼ˆPantry Itemsï¼‰ã®æ‰±ã„:**
- ã€Œå¤§ã•ã˜/å°ã•ã˜/å°‘ã€…/é©é‡/ã²ã¨ã¤ã¾ã¿/é©å®œã€ãªã©ã®å˜ä½ã¯è³¼å…¥å˜ä½ã§ã¯ãªã„
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§å˜ä½ãƒ™ãƒ¼ã‚¹ã§åˆ¤å®šã—ã€ã€Œå®¶ã«ã‚ã‚Œã°OKã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ†é›¢è¡¨ç¤º
- å¸¸å‚™å“ã¯è²·ã„ç‰©ãƒªã‚¹ãƒˆã®ãƒã‚§ãƒƒã‚¯å¯¾è±¡å¤–ï¼ˆå‚è€ƒæƒ…å ±ã¨ã—ã¦è¡¨ç¤ºï¼‰
- å¸¸å‚™å“åˆ¤å®šã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§è¡Œã†ï¼ˆAPIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯å¤‰æ›´ãªã—ï¼‰

**å¸¸å‚™å“åˆ¤å®šãƒ«ãƒ¼ãƒ«ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰:**
```typescript
const PANTRY_UNITS = ["å¤§ã•ã˜", "å°ã•ã˜", "å°‘ã€…", "é©é‡", "ã²ã¨ã¤ã¾ã¿", "é©å®œ"]
const isPantryUnit = (unit: string) => PANTRY_UNITS.some(u => unit.includes(u))
```

**åˆç®—ãƒ­ã‚¸ãƒƒã‚¯ä¾‹:**
```
ãƒ¬ã‚·ãƒ”A: åµ 2å€‹
ãƒ¬ã‚·ãƒ”B: åµ 3å€‹
å†·è”µåº«: åµ 1å€‹
â†’ è²·ã„ç‰©ãƒªã‚¹ãƒˆ: åµ 4å€‹ï¼ˆ5-1ï¼‰
```

**ShoppingItem:**
```json
{
  "id": "01HNK...",
  "name": "é¶ã‚‚ã‚‚è‚‰",
  "quantity": 2,
  "unit": "æš",
  "checked": false,
  "source": "auto" | "manual"
}
```

---

#### GET /shopping-list
è²·ã„ç‰©ãƒªã‚¹ãƒˆå–å¾—

**Response:**
```json
{
  "data": {
    "items": [
      {
        "id": "01HNK...",
        "name": "é¶ã‚‚ã‚‚è‚‰",
        "quantity": 2,
        "unit": "æš",
        "checked": false,
        "source": "auto"
      }
    ]
  }
}
```

---

#### POST /shopping-list/items
æ‰‹å‹•è¿½åŠ 

**Request:**
```json
{
  "name": "ç‰›ä¹³",
  "quantity": 1,
  "unit": "æœ¬"
}
```

**Response:**
```json
{
  "data": {
    "id": "01HNL...",
    "name": "ç‰›ä¹³",
    "quantity": 1,
    "unit": "æœ¬",
    "checked": false,
    "source": "manual"
  }
}
```

---

#### PATCH /shopping-list/items/{id}
ãƒã‚§ãƒƒã‚¯ ON/OFF

**Request:**
```json
{ "checked": true }
```

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "checked": true
  }
}
```

---

#### POST /shopping-list/complete
è²·ã„ç‰©å®Œäº†ï¼ˆãƒã‚§ãƒƒã‚¯æ¸ˆã¿ã‚’å†·è”µåº«ã¸ç§»å‹•ï¼‰

**Response:**
```json
{
  "data": {
    "movedToFridge": 5,
    "remaining": 2
  }
}
```

---

### 4-3. Fridgeï¼ˆå†·è”µåº«ï¼‰API

**è¨­è¨ˆæ–¹é‡:**
- ã€Œä½œã£ãŸã€ã‚’æŠ¼ã™ â†’ è©²å½“ãƒ¬ã‚·ãƒ”ã®é£Ÿæã‚’å†·è”µåº«ã‹ã‚‰è‡ªå‹•ã§å¼•ã
- åœ¨åº«ãŒè¶³ã‚Šãªã„å ´åˆ â†’ 0ã§æ­¢ã‚ã‚‹ï¼ˆãƒã‚¤ãƒŠã‚¹ã«ã—ãªã„ã€ã‚¨ãƒ©ãƒ¼ã«ã‚‚ã—ãªã„ï¼‰
- å‰Šé™¤å±¥æ­´ã¯30æ—¥ä¿æŒã€ãã®å¾Œè‡ªå‹•å‰Šé™¤
- è²·ã„ç‰©å®Œäº† â†’ ãƒã‚§ãƒƒã‚¯æ¸ˆã¿é£ŸæãŒå†·è”µåº«ã«è¿½åŠ ã•ã‚Œã‚‹

**ãƒ‡ãƒ¼ã‚¿ vs UIè¡¨ç¤ºã®é•ã„ï¼ˆé‡è¦ï¼‰:**
- **ãƒ‡ãƒ¼ã‚¿ï¼ˆDBï¼‰**: åŒã˜é£Ÿæã§ã‚‚å˜ä½ãŒé•ãˆã°**åˆ¥ãƒ¬ã‚³ãƒ¼ãƒ‰**ã§ä¿æŒ
- **å†·è”µåº«UI**: åŒã˜é£Ÿæåã¯**1ã‚¢ã‚¤ãƒ†ãƒ ã«ã¾ã¨ã‚ã¦è¡¨ç¤º**ï¼ˆå˜ä½ã¯ç„¡è¦–ã€ã€Œã‚­ãƒ£ãƒ™ãƒ„ã€ã ã‘è¡¨ç¤ºï¼‰
- **è²·ã„ç‰©ãƒªã‚¹ãƒˆUI**: å˜ä½ãŒé•ãˆã°**åˆ¥ã€…ã«è¡¨ç¤º**ï¼ˆæ­£ç¢ºãªæ•°é‡ãŒå¿…è¦ãªãŸã‚ï¼‰
- **è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯**: å†·è”µåº«ã‹ã‚‰å¼•ãéš›ã¯**å˜ä½ã”ã¨ã«åˆ¥ã€…ã«å‡¦ç†**ï¼ˆåŒã˜å˜ä½å„ªå…ˆã§å¼•ãï¼‰

â†’ å†·è”µåº«ã¯ã€Œä½•ãŒã‚ã‚‹ã‹ã€ãŒã‚ã‹ã‚Œã°ååˆ†ã€‚æ­£ç¢ºãªæ•°é‡ç®¡ç†ã¯è²·ã„ç‰©ãƒªã‚¹ãƒˆå´ã§æ‹…ä¿ã€‚

**FridgeItem:**
```json
{
  "id": "01HNK...",
  "name": "åµ",
  "quantity": 6,
  "unit": "å€‹",
  "note": "è³å‘³æœŸé™ 1/30",
  "source": "auto" | "manual",
  "updatedAt": "2026-01-27T10:00:00Z"
}
```

**DeletedFridgeItem:**
```json
{
  "id": "01HNK...",
  "name": "åµ",
  "quantity": 0,
  "unit": "å€‹",
  "deletedAt": "2026-01-25T10:00:00Z"
}
```

---

#### GET /fridge
å†·è”µåº«å–å¾—

**Response:**
```json
{
  "data": {
    "items": [
      {
        "id": "01HNK...",
        "name": "åµ",
        "quantity": 6,
        "unit": "å€‹",
        "note": null,
        "source": "auto",
        "updatedAt": "2026-01-27T10:00:00Z"
      }
    ]
  }
}
```

---

#### POST /fridge/items
æ‰‹å‹•è¿½åŠ 

**Request:**
```json
{
  "name": "ç‰›ä¹³",
  "quantity": 1,
  "unit": "æœ¬",
  "note": "è³å‘³æœŸé™ 2/5"
}
```

**Response:**
```json
{
  "data": {
    "id": "01HNL...",
    "name": "ç‰›ä¹³",
    "quantity": 1,
    "unit": "æœ¬",
    "note": "è³å‘³æœŸé™ 2/5",
    "source": "manual",
    "updatedAt": "2026-01-27T10:00:00Z"
  }
}
```

---

#### PATCH /fridge/items/{id}
ç·¨é›†ï¼ˆæ•°é‡å¤‰æ›´ã€ãƒ¡ãƒ¢è¿½åŠ ãªã©ï¼‰

**Request:**
```json
{
  "quantity": 3,
  "note": "ã‚ã¨å°‘ã—"
}
```

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "quantity": 3,
    "note": "ã‚ã¨å°‘ã—",
    "updatedAt": "2026-01-27T11:00:00Z"
  }
}
```

---

#### DELETE /fridge/items/{id}
å‰Šé™¤ï¼ˆ30æ—¥é–“ã¯å¾©å…ƒå¯èƒ½ï¼‰

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "deletedAt": "2026-01-27T12:00:00Z"
  }
}
```

---

#### GET /fridge/deleted
å‰Šé™¤å±¥æ­´å–å¾—ï¼ˆ30æ—¥ä»¥å†…ï¼‰

**Response:**
```json
{
  "data": {
    "items": [
      {
        "id": "01HNK...",
        "name": "åµ",
        "quantity": 0,
        "unit": "å€‹",
        "deletedAt": "2026-01-25T10:00:00Z"
      }
    ]
  }
}
```

---

#### POST /fridge/items/{id}/restore
å‰Šé™¤ã—ãŸé£Ÿæã‚’å¾©å…ƒ

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "name": "åµ",
    "quantity": 0,
    "unit": "å€‹",
    "source": "manual",
    "updatedAt": "2026-01-27T12:30:00Z"
  }
}
```

---

### 4-4. Recipeï¼ˆãƒ¬ã‚·ãƒ”å¸³ï¼‰API

**è¨­è¨ˆæ–¹é‡:**
- è‡ªåˆ†ã§ä½œæˆã—ãŸãƒ¬ã‚·ãƒ” + ã‚«ã‚¿ãƒ­ã‚°ã‹ã‚‰ä¿å­˜ã—ãŸãƒ¬ã‚·ãƒ”ãŒæ··åœ¨
- ä¿å­˜ã—ãŸãƒ¬ã‚·ãƒ”ã¯ç·¨é›†ä¸å¯ï¼ˆè¤‡è£½ã—ã¦æ–°è¦ä½œæˆã¯å¯èƒ½ï¼‰
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã¯cursoræ–¹å¼

**å¿…é ˆ/ä»»æ„é …ç›®:**
| é …ç›® | APIå | å¿…é ˆ/ä»»æ„ |
|------|-------|----------|
| æ–™ç†å | title | **å¿…é ˆ** |
| ä½•äººå‰ | servings | **å¿…é ˆ** |
| ææ–™ | ingredients | **å¿…é ˆ**ï¼ˆæœ€ä½1ã¤ï¼‰ |
| ä½œã‚Šæ–¹ | steps | **å¿…é ˆ**ï¼ˆæœ€ä½1ã¤ï¼‰ |
| ã‚¿ã‚° | tags | ä»»æ„ |
| å‡ºå…¸å…ƒURL | sourceUrl | ä»»æ„ |
| ä¸­é–“ç´ æ | intermediateMaterials | ä»»æ„ |
| ä½œæˆè€… | authorName | ä»»æ„ |
| èª¿ç†æ™‚é–“ | cookTimeMinutes | ä»»æ„ |
| ã‚µãƒ ãƒã‚¤ãƒ« | thumbnailUrl | ä»»æ„ |

**Recipe:**
```json
{
  "id": "01HNK...",
  "title": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
  "authorName": "Kondatelab",
  "thumbnailUrl": "https://...",
  "sourceUrl": "https://...",
  "servings": 2,
  "cookTimeMinutes": 25,
  "tags": ["æ™‚çŸ­", "å®šç•ª"],
  "ingredients": [
    { "name": "é¶ã‚‚ã‚‚è‚‰", "quantity": 2, "unit": "æš", "order": 1 }
  ],
  "intermediateMaterials": [
    { "title": "ç”˜è¾›ã ã‚Œ", "text": "é†¤æ²¹/ã¿ã‚Šã‚“/ç ‚ç³–", "order": 1 }
  ],
  "steps": [
    { "order": 1, "text": "é¶è‚‰ã‚’ä¸€å£å¤§ã«åˆ‡ã‚‹", "timerMinutes": null }
  ],
  "savedCount": 120,
  "isSaved": true,
  "origin": "created" | "saved",
  "createdAt": "2026-01-20T09:00:00Z",
  "updatedAt": "2026-01-20T09:00:00Z"
}
```

---

#### GET /recipes
ä¸€è¦§å–å¾—ï¼ˆæ¤œç´¢/çµã‚Šè¾¼ã¿/ä¸¦ã³æ›¿ãˆå¯¾å¿œï¼‰

**Query Parameters:**
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ |
|-----------|------|
| limit | å–å¾—ä»¶æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ20ã€æœ€å¤§100ï¼‰ |
| cursor | ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ç”¨ |
| search | ã‚¿ã‚¤ãƒˆãƒ«/ã‚¿ã‚°æ¤œç´¢ |
| tag | ã‚¿ã‚°çµã‚Šè¾¼ã¿ |
| sort | `newest` / `oldest` / `popular` |

**Response:**
```json
{
  "data": {
    "items": [...],
    "nextCursor": "01HNL...",
    "hasMore": true
  }
}
```

---

#### GET /recipes/{id}
è©³ç´°å–å¾—

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "title": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
    ...
  }
}
```

---

#### POST /recipes
æ–°è¦ä½œæˆ

**Request:**
```json
{
  "title": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
  "servings": 2,
  "ingredients": [
    { "name": "é¶ã‚‚ã‚‚è‚‰", "quantity": 2, "unit": "æš" }
  ],
  "steps": [
    { "text": "é¶è‚‰ã‚’ä¸€å£å¤§ã«åˆ‡ã‚‹" }
  ],
  "cookTimeMinutes": 25,
  "tags": ["æ™‚çŸ­", "å®šç•ª"],
  "sourceUrl": "https://...",
  "authorName": "è‡ªåˆ†",
  "intermediateMaterials": [
    { "title": "ç”˜è¾›ã ã‚Œ", "text": "é†¤æ²¹/ã¿ã‚Šã‚“/ç ‚ç³–" }
  ]
}
```

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    ...
  }
}
```

---

#### PATCH /recipes/{id}
ç·¨é›†ï¼ˆorigin: created ã®ã¿å¯èƒ½ï¼‰

**Request:**
```json
{
  "title": "ç”˜è¾›ãƒã‚­ãƒ³ã¨é‡èœç‚’ã‚",
  "cookTimeMinutes": 30
}
```

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "title": "ç”˜è¾›ãƒã‚­ãƒ³ã¨é‡èœç‚’ã‚",
    "cookTimeMinutes": 30,
    "updatedAt": "2026-01-27T15:00:00Z"
  }
}
```

**ã‚¨ãƒ©ãƒ¼ï¼ˆä¿å­˜ãƒ¬ã‚·ãƒ”ã‚’ç·¨é›†ã—ã‚ˆã†ã¨ã—ãŸå ´åˆï¼‰:**
```json
{
  "error": {
    "code": "FORBIDDEN",
    "message": "ä¿å­˜ã—ãŸãƒ¬ã‚·ãƒ”ã¯ç·¨é›†ã§ãã¾ã›ã‚“"
  }
}
```

---

#### DELETE /recipes/{id}

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "deleted": true
  }
}
```

---

### 4-5. RecipeSetï¼ˆã‚»ãƒƒãƒˆï¼‰API

**RecipeSet:**
```json
{
  "id": "01HNK...",
  "title": "å¹³æ—¥5æ—¥ã‚†ã‚‹ã£ã¨ã‚»ãƒƒãƒˆ",
  "authorName": "Kondatelab",
  "description": "å¹³æ—¥ã®çŒ®ç«‹ã‚’ã¾ã¨ã‚ãŸæ™‚çŸ­5æ—¥ã‚»ãƒƒãƒˆ",
  "thumbnailUrl": "https://...",
  "tags": ["æ™‚çŸ­", "å®šç•ª"],
  "recipeIds": ["01HNA...", "01HNB...", "01HNC..."],
  "recipes": [
    { "id": "01HNA...", "title": "...", "thumbnailUrl": "..." }
  ],
  "savedCount": 110,
  "isSaved": true,
  "origin": "created" | "saved",
  "createdAt": "2026-01-20T09:00:00Z",
  "updatedAt": "2026-01-20T09:00:00Z"
}
```

---

#### GET /sets
ä¸€è¦§å–å¾—

**Query Parameters:**
Recipe APIã¨åŒæ§˜ï¼ˆlimit, cursor, search, tag, sortï¼‰

**Response:**
```json
{
  "data": {
    "items": [...],
    "nextCursor": "01HNL...",
    "hasMore": true
  }
}
```

---

#### GET /sets/{id}
è©³ç´°å–å¾—ï¼ˆå«ã¾ã‚Œã‚‹ãƒ¬ã‚·ãƒ”æƒ…å ±ã‚‚è¿”ã™ï¼‰

---

#### POST /sets
æ–°è¦ä½œæˆ

**Request:**
```json
{
  "title": "å¹³æ—¥5æ—¥ã‚†ã‚‹ã£ã¨ã‚»ãƒƒãƒˆ",
  "description": "å¹³æ—¥ã®çŒ®ç«‹ã‚’ã¾ã¨ã‚ãŸæ™‚çŸ­5æ—¥ã‚»ãƒƒãƒˆ",
  "recipeIds": ["01HNA...", "01HNB...", "01HNC..."],
  "tags": ["æ™‚çŸ­", "å®šç•ª"]
}
```

---

#### PATCH /sets/{id}
ç·¨é›†ï¼ˆorigin: created ã®ã¿å¯èƒ½ï¼‰

---

#### DELETE /sets/{id}
å‰Šé™¤

---

### 4-6. Catalogï¼ˆãƒ¬ã‚·ãƒ”ã‚«ã‚¿ãƒ­ã‚°ï¼‰API

**æ€æƒ³:**
- ãƒ¬ã‚·ãƒ”å¸³ = å€‹äººãŒæ‹¡å¼µã—ã¦ã„ã **private** ãªãƒ¬ã‚·ãƒ”å¸³
- ã‚«ã‚¿ãƒ­ã‚° = ã“ã‚“ã ã¦Loopã§å…±æœ‰ã™ã‚‹ **public** ãªãƒ¬ã‚·ãƒ”ã‚«ã‚¿ãƒ­ã‚°

**ãƒ¬ã‚·ãƒ”å¸³ã¨ã®é•ã„:**
- `statusBadges`ï¼ˆãƒ•ãƒªãƒ¼/ä¾¡æ ¼/è³¼å…¥æ¸ˆã¿/é™å®šï¼‰ãŒä»˜ã
- `isPurchased` ãƒ•ãƒ©ã‚°ãŒã‚ã‚‹
- æ–™ç†å®¶æƒ…å ±ï¼ˆcreatorId, creatorNameï¼‰ãŒä»˜ã

**CatalogRecipe:**
```json
{
  "id": "01HNK...",
  "title": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
  "creatorId": "01HNA...",
  "creatorName": "Kondatelab",
  "thumbnailUrl": "https://...",
  "cookTimeMinutes": 25,
  "tags": ["æ™‚çŸ­", "å®šç•ª"],
  "savedCount": 120,
  "statusBadges": [
    { "label": "Â¥680", "variant": "price" }
  ],
  "isPurchased": false,
  "isSaved": false,
  "createdAt": "2026-01-20T09:00:00Z"
}
```

---

#### GET /catalog/recipes
ä¸€è¦§å–å¾—

**Query Parameters:**
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ |
|-----------|------|
| limit | å–å¾—ä»¶æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ20ã€æœ€å¤§100ï¼‰ |
| cursor | ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ç”¨ |
| search | ã‚¿ã‚¤ãƒˆãƒ«/ã‚¿ã‚°/ä½œæˆè€…æ¤œç´¢ |
| tag | ã‚¿ã‚°çµã‚Šè¾¼ã¿ |
| sort | `newest` / `popular` / `recommended` |
| status | `free` / `paid` / `purchased` |
| cookTime | `15` / `30` / `45`ï¼ˆåˆ†ä»¥å†…ï¼‰ |
| creatorId | æ–™ç†å®¶ã§çµã‚Šè¾¼ã¿ |

**Response:**
```json
{
  "data": {
    "items": [...],
    "nextCursor": "01HNL...",
    "hasMore": true
  }
}
```

---

#### GET /catalog/sets
ä¸€è¦§å–å¾—ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯recipesã¨åŒæ§˜ï¼‰

---

#### GET /catalog/recipes/{id}
è©³ç´°å–å¾—ï¼ˆææ–™/æ‰‹é †å«ã‚€ã€è³¼å…¥æ¸ˆã¿ã®å ´åˆã®ã¿å…¨æƒ…å ±ï¼‰

**æœªè³¼å…¥ã®å ´åˆ:**
- ã‚¿ã‚¤ãƒˆãƒ«ã€ã‚µãƒ ãƒã‚¤ãƒ«ã€ã‚¿ã‚°ã€ä½œæˆè€…ã¯è¦‹ã‚Œã‚‹
- ææ–™/æ‰‹é †ã¯è¦‹ã‚Œãªã„ or ä¸€éƒ¨ã®ã¿

---

#### GET /catalog/sets/{id}
è©³ç´°å–å¾—

---

#### POST /catalog/recipes/{id}/save
ãƒ¬ã‚·ãƒ”å¸³ã«ä¿å­˜

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "savedToRecipeBook": true
  }
}
```

---

#### POST /catalog/sets/{id}/save
ã‚»ãƒƒãƒˆã‚’ãƒ¬ã‚·ãƒ”å¸³ã«ä¿å­˜

---

#### POST /catalog/recipes/{id}/purchase
è³¼å…¥

**Request:**
```json
{
  "paymentMethodId": "01HNP..."
}
```

**Response:**
```json
{
  "data": {
    "purchaseId": "01HNQ...",
    "recipeId": "01HNK...",
    "amount": 680,
    "currency": "JPY",
    "status": "succeeded"
  }
}
```

---

#### POST /catalog/sets/{id}/purchase
ã‚»ãƒƒãƒˆè³¼å…¥

---

## 4-7. Authï¼ˆèªè¨¼ï¼‰APIã€ç¢ºå®šã€‘

### èªè¨¼æ–¹å¼
- **Hosted UI + Amplify SDK** ã‚’æ¡ç”¨
- ãƒ­ã‚°ã‚¤ãƒ³/æ–°è¦ç™»éŒ²/ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ â†’ Cognitoã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸è¦ï¼‰
- ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç† â†’ Amplify SDKã«ä»»ã›ã‚‹ï¼ˆlocalStorageï¼‰
- ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ â†’ Amplify SDKè‡ªå‹•
- API Gateway â†’ Cognito Authorizerã§ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼

### ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ç®¡ç†
- **Cognito**: èªè¨¼ã®ã¿æ‹…å½“
- **DynamoDBï¼ˆUserãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ç®¡ç†

### Userãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ
```json
{
  "id": "01HNK...",
  "cognitoSub": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "email": "user@example.com",
  "name": "ãŸã‚ã†",
  "role": "user",
  "avatarUrl": "https://...",
  "createdAt": "2026-01-01T00:00:00Z",
  "updatedAt": "2026-01-01T00:00:00Z"
}
```

**DynamoDBã‚­ãƒ¼è¨­è¨ˆ:**
- PK: `USER#<id>`
- SK: `PROFILE`
- GSI1-PK: `COGNITO#<cognitoSub>`

### role ã®ç¨®é¡
åˆæœŸãƒªãƒªãƒ¼ã‚¹: `user` | `user_plus` ã®ã¿
å°†æ¥è¿½åŠ : `creator` | `creator_plus`

```typescript
type UserRole = "user" | "user_plus" | "creator" | "creator_plus"
```

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
```
GET /auth/me    ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
```

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "email": "user@example.com",
    "name": "ãŸã‚ã†",
    "role": "user",
    "avatarUrl": "https://...",
    "createdAt": "2026-01-01T00:00:00Z"
  }
}
```

### æ–°è¦ç™»éŒ²æ™‚ã®ãƒ•ãƒ­ãƒ¼
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒCognito Hosted UIã§ç™»éŒ²
2. Cognito Post Confirmation Triggerï¼ˆLambdaï¼‰ãŒç™ºç«
3. LambdaãŒDynamoDBã«Userãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ
   - cognitoSubã‚’å–å¾—
   - ULIDã§idã‚’ç”Ÿæˆ
   - role: "user" ã§åˆæœŸåŒ–
```

---

## 4-8. Importï¼ˆãƒ¬ã‚·ãƒ”å–ã‚Šè¾¼ã¿ï¼‰APIã€ç¢ºå®šã€‘

### æ–¹é‡
- **JSON-LDå„ªå…ˆ** â†’ ã‚ã‚Œã°ä½¿ã†ï¼ˆæ­£ç¢ºã€åˆ©ç”¨è¦ç´„çš„ã«ã‚‚ã‚¯ãƒªãƒ¼ãƒ³ï¼‰
- **LLMãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯** â†’ JSON-LDãªã„å ´åˆ or ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›
- **ç¢ºèªç”»é¢ã§ä¿®æ­£å¯èƒ½** â†’ å³æ™‚ç¢ºå®šã§ã¯ãªã„

### LLMé¸å®š
- **Amazon Bedrock + Claude Haiku** ã§é–‹å§‹
- ç²¾åº¦ä¸è¶³ãªã‚‰Sonnetã«åˆ‡ã‚Šæ›¿ãˆï¼ˆç’°å¢ƒå¤‰æ•°ã§å³åº§ã«å¤‰æ›´å¯èƒ½ï¼‰
- ã‚³ã‚¹ãƒˆ: ç´„0.2å††/å›ï¼ˆHaikuï¼‰ã€ç´„2å††/å›ï¼ˆSonnetï¼‰

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### POST /import/parse
URLã¾ãŸã¯ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ãƒ¬ã‚·ãƒ”æƒ…å ±ã‚’æŠ½å‡º

**Request:**
```json
{
  "type": "url" | "text",
  "content": "https://... ã¾ãŸã¯ ãƒ†ã‚­ã‚¹ãƒˆ"
}
```

**å‡¦ç†ãƒ•ãƒ­ãƒ¼:**
```
type === "url" ã®å ´åˆ:
  1. HTMLãƒ•ã‚§ãƒƒãƒ
  2. JSON-LDæ¢ã™
     â†’ ã‚ã‚Š: ãƒ‘ãƒ¼ã‚¹ã—ã¦è¿”ã™
     â†’ ãªã—: æœ¬æ–‡ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º â†’ LLMï¼ˆBedrock + Claudeï¼‰ã§ãƒ‘ãƒ¼ã‚¹

type === "text" ã®å ´åˆ:
  1. LLMï¼ˆBedrock + Claudeï¼‰ã§ãƒ‘ãƒ¼ã‚¹
```

**Response:**
```json
{
  "data": {
    "draft": {
      "title": "ç”˜è¾›ãƒã‚­ãƒ³",
      "servings": 2,
      "ingredients": [
        { "name": "é¶ã‚‚ã‚‚è‚‰", "quantity": 2, "unit": "æš" }
      ],
      "steps": [
        { "text": "é¶è‚‰ã‚’ä¸€å£å¤§ã«åˆ‡ã‚‹" }
      ],
      "sourceUrl": "https://...",
      "authorName": "ã‚¯ãƒƒã‚¯ãƒ‘ãƒƒãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼",
      "cookTimeMinutes": null,
      "tags": []
    },
    "source": "json-ld" | "llm",
    "confidence": "high" | "medium" | "low"
  }
}
```

---

## 4-9. Paymentï¼ˆæ±ºæ¸ˆï¼‰APIã€ç¢ºå®šã€‘

### æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
- **Stripe** ã‚’æ¡ç”¨
- å°†æ¥çš„ã«PayPayå¯¾å¿œã‚‚å¯èƒ½ï¼ˆStripeã§å¯¾å¿œæ¸ˆã¿ï¼‰

### åˆæœŸãƒªãƒªãƒ¼ã‚¹ã®ã‚¹ã‚³ãƒ¼ãƒ—
- âœ… ã‚¯ãƒ¬ã‚«ç™»éŒ²/ç®¡ç†
- âœ… è³¼å…¥ï¼ˆå…¬å¼æœ‰æ–™ãƒ¬ã‚·ãƒ”ç”¨ï¼‰
- âœ… è³¼å…¥å±¥æ­´
- âœ… ã‚µãƒ–ã‚¹ã‚¯ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼+ï¼‰
- âŒ Stripe Connectï¼ˆã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã„ãªã„ã®ã§ä¸è¦ï¼‰

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```
# æ”¯æ‰•ã„æ–¹æ³•
POST   /payment-methods           ã‚¯ãƒ¬ã‚«ç™»éŒ²
GET    /payment-methods           ç™»éŒ²æ¸ˆã¿ä¸€è¦§
DELETE /payment-methods/{id}      å‰Šé™¤

# è³¼å…¥
POST   /purchases                 è³¼å…¥å®Ÿè¡Œ
GET    /purchases                 è³¼å…¥å±¥æ­´

# ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
POST   /subscriptions             ã‚µãƒ–ã‚¹ã‚¯é–‹å§‹ï¼ˆuser_plusï¼‰
GET    /subscriptions             ç¾åœ¨ã®çŠ¶æ³
DELETE /subscriptions             è§£ç´„
```

#### POST /payment-methods
**Request:**
```json
{
  "paymentMethodId": "pm_xxx"
}
```

**Response:**
```json
{
  "data": {
    "id": "pm_xxx",
    "brand": "visa",
    "last4": "4242",
    "expMonth": 12,
    "expYear": 2028,
    "isDefault": true
  }
}
```

#### POST /purchases
**Request:**
```json
{
  "itemType": "recipe" | "set",
  "itemId": "01HNK...",
  "paymentMethodId": "pm_xxx"
}
```

**Response:**
```json
{
  "data": {
    "purchaseId": "01HNQ...",
    "itemType": "recipe",
    "itemId": "01HNK...",
    "itemTitle": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
    "amount": 680,
    "currency": "JPY",
    "status": "succeeded",
    "purchasedAt": "2026-01-27T15:00:00Z"
  }
}
```

#### POST /subscriptions
**Request:**
```json
{
  "planId": "user_plus",
  "paymentMethodId": "pm_xxx"
}
```

**Response:**
```json
{
  "data": {
    "subscriptionId": "sub_xxx",
    "planId": "user_plus",
    "status": "active",
    "currentPeriodEnd": "2026-02-27T00:00:00Z"
  }
}
```

---

## 4-10. Creatorï¼ˆæ–™ç†å®¶ï¼‰APIã€åˆæœŸãƒªãƒªãƒ¼ã‚¹ã§ã¯å®Ÿè£…ã—ãªã„ã€‘

åˆæœŸãƒªãƒªãƒ¼ã‚¹ã§ã¯ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼æ©Ÿèƒ½ã¯å…¬é–‹ã—ãªã„ã€‚
å°†æ¥ã®ãŸã‚ã«æ–¹é‡ã®ã¿è¨˜éŒ²ã€‚

### å°†æ¥ã®æ–¹é‡
- **Stripe Connect Express** ã§ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¸ã®å£²ä¸Šåˆ†é…ã‚’è‡ªå‹•åŒ–
- æŒ¯è¾¼ã‚¿ã‚¤ãƒŸãƒ³ã‚°: é€±1å› or æœˆ1å›ï¼ˆè‡ªå‹•ï¼‰
- æ‰‹æ•°æ–™: 10%ã€œ15%ï¼ˆå–å¼•æ‰‹æ•°æ–™ï¼‰

### å°†æ¥å®Ÿè£…ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
```
POST   /creator/register          ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ç™»éŒ²ï¼ˆè²·ã„åˆ‡ã‚Š1,200å††ï¼‰
GET    /creator/profile           è‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—
PATCH  /creator/profile           ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†
GET    /creators/{id}             æ–™ç†å®¶è©³ç´°ï¼ˆå…¬é–‹ãƒšãƒ¼ã‚¸ï¼‰
GET    /creators/{id}/recipes     æ–™ç†å®¶ã®ãƒ¬ã‚·ãƒ”ä¸€è¦§
GET    /creators/{id}/sets        æ–™ç†å®¶ã®ã‚»ãƒƒãƒˆä¸€è¦§

# Connect
POST   /connect/onboarding        Connectã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°é–‹å§‹
GET    /connect/status            Connectç™»éŒ²çŠ¶æ³
GET    /connect/dashboard-link    Stripeãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸ã®ãƒªãƒ³ã‚¯
GET    /connect/balance           å£²ä¸Šæ®‹é«˜
```

### ã‚µãƒ–ã‚¹ã‚¯ï¼ˆå°†æ¥è¿½åŠ ï¼‰
```
POST /subscriptions ã§ planId: "creator_plus" ã‚’æŒ‡å®š
```

---

## 4-11. Notificationï¼ˆé€šçŸ¥ï¼‰APIã€ç¢ºå®šã€‘

### é€šçŸ¥ã®ç¨®é¡
| ç¨®é¡ | å¯¾è±¡ | ä¾‹ |
|------|------|-----|
| **ãƒ‹ãƒ¥ãƒ¼ã‚¹** | å…¨å“¡ or ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼ | é‹å–¶ãŠçŸ¥ã‚‰ã›ã€ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã‹ã‚‰ã®ãŠçŸ¥ã‚‰ã›ï¼ˆå°†æ¥ï¼‰ |
| **ã‚ãªãŸå®›ã¦** | å€‹äºº | ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€PWAãƒ›ãƒ¼ãƒ è¿½åŠ ä¿ƒã—ã€è³¼å…¥å®Œäº†ãªã© |

### ã€Œã‚ãªãŸå®›ã¦ã€ã®åˆæœŸãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
- **åˆå›ãƒ­ã‚°ã‚¤ãƒ³æ™‚**: ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç³»é€šçŸ¥ï¼ˆä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰ãªã©ï¼‰ã‚’ã‚ãªãŸå®›ã¦ã«é€ä¿¡
- **ãƒ¬ã‚·ãƒ”è¿½åŠ å¾Œãªã©**: PWAãƒ›ãƒ¼ãƒ ç”»é¢è¿½åŠ ã®ä¿ƒã—
- **å°†æ¥è¿½åŠ **: è³¼å…¥å®Œäº†ã€ã‚µãƒ–ã‚¹ã‚¯æ›´æ–°ãªã©

### é…ä¿¡æ–¹æ³•
- ã‚¢ãƒ—ãƒªå†…é€šçŸ¥ï¼ˆãƒ™ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ + ä¸€è¦§ç”»é¢ï¼‰
- ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ï¼ˆWeb Push / FCMï¼‰
- ãƒ¡ãƒ¼ãƒ« â†’ âŒ ã‚„ã‚‰ãªã„

### æ—¢èª­ç®¡ç†æ–¹å¼
**ã€Œæ—¢èª­ã ã‘ç®¡ç†ã€æ–¹å¼ã‚’æ¡ç”¨**
- ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå…±é€šï¼‰: id, title, body, imageUrl, linkUrl, createdAt
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æ—¢èª­ãƒ†ãƒ¼ãƒ–ãƒ«: userId, newsId, readAt
- ã‚¹ã‚±ãƒ¼ãƒ«ã—ã‚„ã™ã„æ§‹é€ 

### ãƒ‹ãƒ¥ãƒ¼ã‚¹è¡¨ç¤ºã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆé‡è¦ï¼‰
**æ–°è¦ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«éå»ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å¤§é‡è¡¨ç¤ºã—ãªã„**
- ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—æ™‚: `createdAt >= user.createdAt` ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²æ—¥æ™‚ä»¥é™ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®ã¿è¡¨ç¤ºã•ã‚Œã‚‹
- ã‚ãªãŸå®›ã¦ï¼ˆpersonalï¼‰ã¯å…ƒã€…å€‹äººå®›ã¦ãªã®ã§ãƒ•ã‚£ãƒ«ã‚¿ä¸è¦

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```
# é€šçŸ¥ä¸€è¦§
GET    /notifications              é€šçŸ¥ä¸€è¦§å–å¾—
POST   /notifications/read         æ—¢èª­ã«ã™ã‚‹ï¼ˆå€‹åˆ¥ or å…¨éƒ¨ï¼‰

# ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥
POST   /push-tokens                ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ç™»éŒ²
DELETE /push-tokens/{token}        ãƒˆãƒ¼ã‚¯ãƒ³å‰Šé™¤

# é€šçŸ¥è¨­å®š
GET    /notification-settings      é€šçŸ¥è¨­å®šå–å¾—
PATCH  /notification-settings      é€šçŸ¥è¨­å®šå¤‰æ›´
```

#### GET /notifications
**Query Parameters:**
- `limit`: å–å¾—ä»¶æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ20ï¼‰
- `cursor`: ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
- `type`: `news` | `personal` | `all`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰

**Response:**
```json
{
  "data": {
    "items": [
      {
        "id": "01HNK...",
        "type": "news",
        "title": "æ–°æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹ã®ãŠçŸ¥ã‚‰ã›",
        "body": "ãƒ¬ã‚·ãƒ”å–ã‚Šè¾¼ã¿æ©Ÿèƒ½ãŒãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ã—ã¾ã—ãŸï¼",
        "imageUrl": "https://...",
        "linkUrl": "/news/01HNK...",
        "isRead": false,
        "createdAt": "2026-01-27T10:00:00Z"
      }
    ],
    "unreadCount": 3,
    "nextCursor": "01HNM...",
    "hasMore": true
  }
}
```

#### POST /notifications/read
**Request:**
```json
{
  "notificationIds": ["01HNK...", "01HNL..."]
}
```
ã¾ãŸã¯å…¨ã¦æ—¢èª­:
```json
{
  "all": true
}
```

**Response:**
```json
{
  "data": {
    "readCount": 3,
    "unreadCount": 0
  }
}
```

#### POST /push-tokens
**Request:**
```json
{
  "token": "fcm-device-token-xxx",
  "platform": "web"
}
```

#### GET /notification-settings
**Response:**
```json
{
  "data": {
    "pushEnabled": true,
    "categories": {
      "news": true,
      "personal": true
    }
  }
}
```

#### PATCH /notification-settings
**Request:**
```json
{
  "pushEnabled": true,
  "categories": {
    "news": true,
    "personal": false
  }
}
```

---

## åˆæœŸãƒªãƒªãƒ¼ã‚¹ã®ã‚¹ã‚³ãƒ¼ãƒ—ï¼ˆé‡è¦ï¼‰

### å…¬é–‹ã™ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
| ãƒ—ãƒ©ãƒ³ | ä¾¡æ ¼ | åˆæœŸãƒªãƒªãƒ¼ã‚¹ |
|--------|------|-------------|
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ | ç„¡æ–™ | âœ… |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼+ | æœˆé¡500å†† | âœ… |
| ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ | è²·ã„åˆ‡ã‚Š1,200å†† | âŒ |
| ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼+ | æœˆé¡800å†† | âŒ |

### å…¬é–‹ã™ã‚‹æ©Ÿèƒ½
| æ©Ÿèƒ½ | åˆæœŸãƒªãƒªãƒ¼ã‚¹ |
|------|-------------|
| çŒ®ç«‹è¡¨/è²·ã„ç‰©ãƒªã‚¹ãƒˆ/å†·è”µåº« | âœ… |
| ãƒ¬ã‚·ãƒ”å¸³ï¼ˆç§çš„ï¼‰ | âœ… |
| ã‚«ã‚¿ãƒ­ã‚°ï¼ˆå…¬å¼ãƒ¬ã‚·ãƒ”ã®ã¿ï¼‰ | âœ… |
| ãƒ¬ã‚·ãƒ”å–ã‚Šè¾¼ã¿ï¼ˆAIï¼‰ | âœ… |
| è³¼å…¥æ©Ÿèƒ½ï¼ˆå…¬å¼æœ‰æ–™ãƒ¬ã‚·ãƒ”ç”¨ï¼‰ | âœ… |
| ã‚µãƒ–ã‚¹ã‚¯ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼+ï¼‰ | âœ… |
| ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼æ©Ÿèƒ½ | âŒ |
| ãƒ•ã‚©ãƒ­ãƒ¼æ©Ÿèƒ½ | âŒ |
| Stripe Connect | âŒ |

---

## æœ¬æ—¥ã®æˆæœã¾ã¨ã‚ï¼ˆ2026-01-27 ç¶™ç¶šï¼‰

### å‰å›ç¢ºå®š
1. **IDæ–¹å¼**: ULID
2. **ã‚¨ãƒ©ãƒ¼å½¢å¼**: 400=å½¢å¼ã‚¨ãƒ©ãƒ¼ã€422=ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹å¤§æ–‡å­—
3. **äººæ°—æŒ‡æ¨™**: savedCountï¼ˆMVPï¼‰

### ä»Šå›ç¢ºå®š
4. **èªè¨¼**: Hosted UI + Amplify SDKã€DynamoDBã§Userç®¡ç†
5. **Import**: JSON-LDå„ªå…ˆ + Bedrock Claude Haikuãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
6. **æ±ºæ¸ˆ**: Stripeã€åˆæœŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼+ã‚µãƒ–ã‚¹ã‚¯ + å…¬å¼æœ‰æ–™ãƒ¬ã‚·ãƒ”è³¼å…¥ã®ã¿
7. **åˆæœŸãƒªãƒªãƒ¼ã‚¹ã‚¹ã‚³ãƒ¼ãƒ—**: ãƒ¦ãƒ¼ã‚¶ãƒ¼/ãƒ¦ãƒ¼ã‚¶ãƒ¼+ã®2ãƒ—ãƒ©ãƒ³ã®ã¿
8. **å†·è”µåº«UI**: åŒã˜é£Ÿæã¯å˜ä½é•ã„ã§ã‚‚1ã‚¢ã‚¤ãƒ†ãƒ è¡¨ç¤ºï¼ˆãƒ‡ãƒ¼ã‚¿ã¯åˆ¥ä¿æŒï¼‰
9. **ã‚«ãƒ†ã‚´ãƒªã¨ã‚¿ã‚°ã®é–¢ä¿‚**: ã‚«ãƒ†ã‚´ãƒªã¯ç‹¬ç«‹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã§ã¯ãªãã€ã‚¿ã‚°ã®ã€Œè¡¨ç¤ºè¨­å®šã€ã¨ã—ã¦æ‰±ã†

### ã‚«ãƒ†ã‚´ãƒªè¨­è¨ˆï¼ˆé‡è¦ï¼‰
**ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹å‹ã‚’æ¡ç”¨**ï¼ˆå‡çµã‚·ãƒ¼ãƒˆã®è¨­è¨ˆã¯å¤ã„æƒ³å®šã§ä½¿ã‚ãªã„ï¼‰

- ã‚«ãƒ†ã‚´ãƒª = ã€Œã©ã®ã‚¿ã‚°ã‚’å·¦å´ã®ä»˜ç®‹ã‚¿ãƒ–ã«è¡¨ç¤ºã™ã‚‹ã‹ã€ã®è¨­å®š
- ãƒ¬ã‚·ãƒ”ãŒãã®ã‚¿ã‚°ã‚’æŒã£ã¦ã„ã‚Œã°ã€ãã®ã‚«ãƒ†ã‚´ãƒªã«è¡¨ç¤ºã•ã‚Œã‚‹
- åŒã˜ãƒ¬ã‚·ãƒ”ãŒè¤‡æ•°ã‚«ãƒ†ã‚´ãƒªã«å‡ºã‚‹ï¼ˆui-proto-contractæº–æ‹ ï¼‰

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ :**
```
# ãƒ¬ã‚·ãƒ”
Recipe: tags = ["æ™‚çŸ­", "å®šç•ª", "é¶è‚‰"]

# ã‚«ãƒ†ã‚´ãƒªè¨­å®šï¼ˆã©ã®ã‚¿ã‚°ã‚’å·¦å´ã«è¡¨ç¤ºã™ã‚‹ã‹ï¼‰
CategorySetting:
  - userId
  - scope: book | catalog
  - tagName: "æ™‚çŸ­"    â† ã‚¿ã‚°åã‚’å‚ç…§
  - order: 1
  - isDefault: false
```

- ã‚«ãƒ†ã‚´ãƒªè¿½åŠ  = ã€Œã“ã®ã‚¿ã‚°åã§ã‚«ãƒ†ã‚´ãƒªã‚’ä½œã‚‹ã€
- ã‚«ãƒ†ã‚´ãƒªã«è¡¨ç¤º = ã€Œãã®ã‚¿ã‚°ã‚’æŒã¤ãƒ¬ã‚·ãƒ”ã‚’æŠ½å‡ºã€

### å®Œäº†ã—ãŸAPIå®šç¾©
- âœ… Planï¼ˆçŒ®ç«‹ï¼‰
- âœ… Shoppingï¼ˆè²·ã„ç‰©ãƒªã‚¹ãƒˆï¼‰
- âœ… Fridgeï¼ˆå†·è”µåº«ï¼‰
- âœ… Recipe/Setï¼ˆãƒ¬ã‚·ãƒ”å¸³ï¼‰
- âœ… Catalogï¼ˆãƒ¬ã‚·ãƒ”ã‚«ã‚¿ãƒ­ã‚°ï¼‰
- âœ… Authï¼ˆèªè¨¼ï¼‰
- âœ… Importï¼ˆãƒ¬ã‚·ãƒ”å–ã‚Šè¾¼ã¿ï¼‰
- âœ… Paymentï¼ˆæ±ºæ¸ˆï¼‰
- âœ… Creatorï¼ˆæ–™ç†å®¶ï¼‰â€»å°†æ¥æ–¹é‡ã®ã¿
- âœ… Notificationï¼ˆé€šçŸ¥ï¼‰

### å…¨APIå®šç¾©å®Œäº†ï¼

---

## 4-12. CookingLog / Archiveï¼ˆæ–™ç†ãƒ­ã‚°ãƒ»ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼‰ã€ç¢ºå®šã€‘

### æ–¹é‡
- åˆæœŸãƒªãƒªãƒ¼ã‚¹ã‹ã‚‰å®Ÿè£…
- ã€Œä½œã£ãŸã€æŠ¼ä¸‹æ™‚ã«**è‡ªå‹•è¨˜éŒ²**ï¼ˆæ‰‹å‹•è¿½åŠ ã¯å°†æ¥ï¼‰
- å†™çœŸ/ã‚³ãƒ¡ãƒ³ãƒˆã¯**å°†æ¥å¯¾å¿œ**

### ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

**CookingLog:**
```json
{
  "id": "01HNK...",
  "userId": "01HNA...",
  "date": "2026-01-27",
  "recipeId": "01HNJ...",
  "recipeTitle": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
  "recipeThumbnailUrl": "https://...",
  "createdAt": "2026-01-27T19:30:00Z"
}
```

**ãƒã‚¤ãƒ³ãƒˆ:**
- `date` ã¯æ—¥ä»˜ã®ã¿ï¼ˆæ™‚åˆ»ãªã—ï¼‰â†’ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºç”¨
- `recipeTitle` / `recipeThumbnailUrl` ã¯éæ­£è¦åŒ–ã§ä¿æŒï¼ˆãƒ¬ã‚·ãƒ”å‰Šé™¤ã•ã‚Œã¦ã‚‚å±¥æ­´ã¯æ®‹ã‚‹ï¼‰
- å°†æ¥è¿½åŠ : `photoUrl`, `comment`

### è‡ªå‹•è¨˜éŒ²ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°

```
PATCH /plan/items/{id} ã§ isCooked: true
  â†“
ã‚µãƒ¼ãƒãƒ¼å´ã§ CookingLog ã‚’è‡ªå‹•ä½œæˆ
  - date: ä»Šæ—¥ã®æ—¥ä»˜
  - recipeId: PlanItemã®recipeId
  - recipeTitle/thumbnailUrl: Recipeã‹ã‚‰å–å¾—
```

â€» `isCooked: false`ï¼ˆå–ã‚Šæ¶ˆã—ï¼‰ã—ãŸå ´åˆ â†’ CookingLogã¯**å‰Šé™¤ã—ãªã„**ï¼ˆä¸€åº¦ä½œã£ãŸã‚‚ã®ã¯å±¥æ­´ã¨ã—ã¦æ®‹ã™ï¼‰

### DynamoDBã‚­ãƒ¼è¨­è¨ˆ

```
PK: USER#<userId>
SK: LOG#<date>#<id>

ä¾‹:
PK: USER#01HNA...
SK: LOG#2026-01-27#01HNK...
```

â†’ `begins_with(SK, "LOG#2026-01")` ã§æœˆå˜ä½å–å¾—å¯èƒ½

### UIãƒ•ãƒ­ãƒ¼ï¼ˆã‚¹ãƒˆãƒ¼ãƒªãƒ¼å½¢å¼ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰

```
[ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç”»é¢]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     2026å¹´1æœˆ               â”‚
â”œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¤
â”‚æ—¥â”‚æœˆâ”‚ç«â”‚æ°´â”‚æœ¨â”‚é‡‘â”‚åœŸâ”‚
â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
â”‚  â”‚  â”‚  â”‚ 1â”‚ 2â”‚ 3â”‚ 4â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ğŸ³â”‚  â”‚ğŸ³â”‚  â† ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º
â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
â”‚...                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â†“ ğŸ³ã‚¯ãƒªãƒƒã‚¯

[ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆã‚¹ãƒˆãƒ¼ãƒªãƒ¼å½¢å¼ï¼‰]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â—â—‹â—‹   â† ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼    â”‚
â”‚                             â”‚
â”‚   ğŸ–¼ ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ    â”‚
â”‚                             â”‚
â”‚   â† ã‚¹ãƒ¯ã‚¤ãƒ—ã§æ¬¡ã¸ â†’        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**UIä»•æ§˜:**
- 1å“ã®å ´åˆ: ãã®ã¾ã¾ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º
- è¤‡æ•°å“ã®å ´åˆ: ã‚¤ãƒ³ã‚¹ã‚¿ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å½¢å¼ã§ã‚¹ãƒ¯ã‚¤ãƒ—ã§åˆ‡ã‚Šæ›¿ãˆ
- ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆâ—â—‹â—‹ï¼‰ã§ä½•å“ç›®ã‹ã‚ã‹ã‚‹

### APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### GET /archive
æœˆå˜ä½ã§ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

**Query Parameters:**
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ |
|-----------|------|
| month | `YYYY-MM` å½¢å¼ï¼ˆå¿…é ˆï¼‰ |

**Response:**
```json
{
  "data": {
    "month": "2026-01",
    "days": [
      {
        "date": "2026-01-20",
        "count": 2,
        "hasLogs": true
      },
      {
        "date": "2026-01-21",
        "count": 1,
        "hasLogs": true
      }
    ],
    "totalCount": 15
  }
}
```

#### GET /archive/{date}
ç‰¹å®šæ—¥ã®æ–™ç†ãƒ­ã‚°è©³ç´°ã‚’å–å¾—ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºç”¨ï¼‰

**Path Parameter:**
- `date`: `YYYY-MM-DD` å½¢å¼

**Response:**
```json
{
  "data": {
    "date": "2026-01-27",
    "logs": [
      {
        "id": "01HNK...",
        "recipeId": "01HNJ...",
        "recipeTitle": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
        "recipeThumbnailUrl": "https://...",
        "createdAt": "2026-01-27T19:30:00Z"
      },
      {
        "id": "01HNL...",
        "recipeId": "01HNM...",
        "recipeTitle": "ã‚µãƒ¼ãƒ¢ãƒ³ã®ãƒ ãƒ‹ã‚¨ãƒ«",
        "recipeThumbnailUrl": "https://...",
        "createdAt": "2026-01-27T20:00:00Z"
      }
    ]
  }
}
```

---

## å°†æ¥ã®ãŸã‚ã«è¦šãˆã¦ãŠãæ–¹é‡

### Stripe Connect Express
- ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹æ™‚ã«å°å…¥
- å£²ä¸Šåˆ†é…ã®è‡ªå‹•åŒ–ï¼ˆé€±1/æœˆ1ã§æŒ¯è¾¼ï¼‰
- ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¯åˆå›ã«ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆæœ¬äººç¢ºèªã€éŠ€è¡Œå£åº§ç™»éŒ²ï¼‰

### ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼æ©Ÿèƒ½
- ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ç™»éŒ²: è²·ã„åˆ‡ã‚Š1,200å††
- ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼+: æœˆé¡800å††ï¼ˆæœ‰æ–™ãƒ¬ã‚·ãƒ”è²©å£²ã€ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ä½œæˆå¯èƒ½ï¼‰
- ãƒ•ã‚©ãƒ­ãƒ¼æ©Ÿèƒ½ã¯ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ãƒªãƒªãƒ¼ã‚¹ã¨åŒæ™‚ã«å°å…¥

---

## 4-13. ExternalShareï¼ˆå¤–éƒ¨å…±æœ‰ï¼‰APIã€ç¢ºå®šã€‘

### ä»•æ§˜ã‚µãƒãƒªãƒ¼

| é …ç›® | å†…å®¹ |
|------|------|
| ç›®çš„ | ãƒ¬ã‚·ãƒ”/ã‚»ãƒƒãƒˆã‚’å¤–éƒ¨ã«å…±æœ‰ï¼ˆå‘ŠçŸ¥æ‹¡æ•£ã€ãŠã™ã™ã‚ç´¹ä»‹ï¼‰ |
| é–²è¦§è€…ã®ãƒ­ã‚°ã‚¤ãƒ³ | ä¸è¦ï¼ˆã‚²ã‚¹ãƒˆOKï¼‰ |
| æœ‰åŠ¹æœŸé™ | ç„¡æœŸé™ï¼ˆãƒ¬ã‚·ãƒ”/ã‚»ãƒƒãƒˆå‰Šé™¤ã§è‡ªå‹•ç„¡åŠ¹ï¼‰ |
| åœæ­¢æ©Ÿèƒ½ | ãªã— |
| å‡ºå…¸åˆ¶ç´„ | `authorName` ã‹ `sourceUrl` ã®ã©ã¡ã‚‰ã‹å¿…é ˆ |

### ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«
```
ãƒ¬ã‚·ãƒ”/ã‚»ãƒƒãƒˆãŒå­˜åœ¨ã™ã‚‹ â†’ å…±æœ‰URLã‚‚æœ‰åŠ¹
ãƒ¬ã‚·ãƒ”/ã‚»ãƒƒãƒˆã‚’å‰Šé™¤   â†’ å…±æœ‰URLã‚‚ç„¡åŠ¹ï¼ˆ404ã«ãªã‚‹ï¼‰
```

- ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼: ãƒ¬ã‚·ãƒ”å¸³ã‹ã‚‰å…±æœ‰ â†’ ãƒ¬ã‚·ãƒ”å¸³ã‹ã‚‰å‰Šé™¤ã§ç„¡åŠ¹åŒ–
- æ–™ç†å®¶: ã‚«ã‚¿ãƒ­ã‚°ã‹ã‚‰å…±æœ‰ â†’ ã‚«ã‚¿ãƒ­ã‚°ã‹ã‚‰å–ã‚Šä¸‹ã’ã§ç„¡åŠ¹åŒ–

### å…±æœ‰URLã®å½¢å¼

```
/share/recipe/{recipeId}
/share/set/{setId}
```

### å‡ºå…¸å…¥åŠ›ã®ãƒ•ãƒ­ãƒ¼

```
å…±æœ‰ãƒœã‚¿ãƒ³æŠ¼ã™
  â†“
authorName or sourceUrl ãŒæ—¢ã«ã‚ã‚‹ï¼Ÿ
  â†’ YES: ãã®ã¾ã¾å…±æœ‰URLç”Ÿæˆ
  â†’ NO:  å‡ºå…¸å…¥åŠ›ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º â†’ å…¥åŠ›å¾Œã«å…±æœ‰URLç”Ÿæˆ
```

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### POST /share
å…±æœ‰URLç”Ÿæˆ

**Request:**
```json
{
  "targetType": "recipe",
  "targetId": "01HNK...",
  "authorName": "è‡ªåˆ†ã®åå‰",
  "sourceUrl": "https://..."
}
```

â€»æ—¢ã«ãƒ¬ã‚·ãƒ”ã« `authorName` / `sourceUrl` ãŒã‚ã‚‹å ´åˆã¯çœç•¥å¯
â€»ã©ã¡ã‚‰ã‚‚ãªã„å ´åˆã¯å¿…é ˆï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ï¼‰

**Response:**
```json
{
  "data": {
    "shareUrl": "https://kondate-loop.com/share/recipe/01HNK...",
    "targetType": "recipe",
    "targetId": "01HNK...",
    "authorName": "è‡ªåˆ†ã®åå‰",
    "sourceUrl": null
  }
}
```

**ã‚¨ãƒ©ãƒ¼ï¼ˆå‡ºå…¸ãªã—ï¼‰:**
```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "å‡ºå…¸ï¼ˆauthorName ã¾ãŸã¯ sourceUrlï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
  }
}
```

---

#### GET /share/recipe/{id}
å…±æœ‰ãƒ¬ã‚·ãƒ”å–å¾—ï¼ˆã‚²ã‚¹ãƒˆé–²è¦§ç”¨ãƒ»èªè¨¼ä¸è¦ï¼‰

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "title": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
    "authorName": "Kondatelab",
    "sourceUrl": null,
    "thumbnailUrl": "https://...",
    "servings": 2,
    "cookTimeMinutes": 25,
    "ingredients": [...],
    "steps": [...],
    "tags": ["æ™‚çŸ­", "å®šç•ª"]
  }
}
```

**ã‚¨ãƒ©ãƒ¼ï¼ˆå‰Šé™¤æ¸ˆã¿ï¼‰:**
```json
{
  "error": {
    "code": "NOT_FOUND",
    "message": "ã“ã®ãƒ¬ã‚·ãƒ”ã¯å­˜åœ¨ã—ã¾ã›ã‚“"
  }
}
```

---

#### GET /share/set/{id}
å…±æœ‰ã‚»ãƒƒãƒˆå–å¾—ï¼ˆã‚²ã‚¹ãƒˆé–²è¦§ç”¨ãƒ»èªè¨¼ä¸è¦ï¼‰

**Response:**
```json
{
  "data": {
    "id": "01HNK...",
    "title": "å¹³æ—¥5æ—¥ã‚†ã‚‹ã£ã¨ã‚»ãƒƒãƒˆ",
    "authorName": "Kondatelab",
    "description": "...",
    "thumbnailUrl": "https://...",
    "recipes": [
      { "id": "...", "title": "...", "thumbnailUrl": "..." }
    ],
    "tags": ["æ™‚çŸ­", "å®šç•ª"]
  }
}
```

---

## ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶šãƒ¡ãƒ¢ï¼ˆ2026-01-28 ã‚»ãƒƒã‚·ãƒ§ãƒ³2ï¼‰

### ä»Šå›ç¢ºå®šã—ãŸå†…å®¹

**1. POST /plan/advanceï¼ˆçŒ®ç«‹æ˜‡æ ¼ï¼‰**
- å…¨å“cooked â†’ å®Œäº†ãƒ¢ãƒ¼ãƒ€ãƒ« â†’ é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ã§ã“ã®APIã‚’å‘¼ã¶
- next â†’ current ã«æ˜‡æ ¼ã€nextã¯ç©ºã«ã€cookedãƒªã‚»ãƒƒãƒˆ

```
POST /plan/advance

Response:
{
  "data": {
    "current": {
      "setId": "01HNJ...",
      "setTitle": "å¹³æ—¥5æ—¥ã‚†ã‚‹ã£ã¨ã‚»ãƒƒãƒˆ",
      "appliedAt": "2026-01-28T10:00:00Z",
      "items": [...]  // å…¨ã¦isCooked: false
    },
    "next": null
  }
}
```

---

**2. ã‚«ãƒ†ã‚´ãƒªAPI**
- scope: book | catalog ã§åˆ¥ã€…ã«ç®¡ç†
- ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹å‹ï¼ˆã‚¿ã‚°åã‚’ã‚«ãƒ†ã‚´ãƒªã¨ã—ã¦è¡¨ç¤ºï¼‰
- è¡¨ç¤ºä»¶æ•°ä¸Šé™: 8ä»¶
- ã€Œå…¨ã¦ã€ã¯å›ºå®šï¼ˆéè¡¨ç¤º/å‰Šé™¤ä¸å¯ï¼‰
- æ—¢å®šã‚«ãƒ†ã‚´ãƒªã¯ç·¨é›†ãƒ»å‰Šé™¤ä¸å¯ã€éè¡¨ç¤ºã¯å¯èƒ½

```
GET /categories?scope=book|catalog     ä¸€è¦§å–å¾—
POST /categories                        è¿½åŠ 
PATCH /categories/{id}                  æ›´æ–°ï¼ˆéè¡¨ç¤ºåˆ‡æ›¿ã€ä¸¦ã³é †ã€ãƒ©ãƒ™ãƒ«ï¼‰
DELETE /categories/{id}                 å‰Šé™¤
```

CategorySetting:
```json
{
  "id": "01HNK...",
  "userId": "01HNA...",
  "scope": "book",
  "tagName": "å’Œé£Ÿ",
  "order": 1,
  "isDefault": true,
  "isHidden": false,
  "colorTheme": "amber"
}
```

---

**3. ä¿å­˜è§£é™¤API**
- DELETEæ–¹å¼ã‚’æ¡ç”¨ï¼ˆRESTfulï¼‰

```
DELETE /catalog/recipes/{id}/save    ãƒ¬ã‚·ãƒ”ä¿å­˜è§£é™¤
DELETE /catalog/sets/{id}/save       ã‚»ãƒƒãƒˆä¿å­˜è§£é™¤

Response:
{
  "data": {
    "recipeId": "01HNK...",
    "saved": false
  }
}
```

---

**4. Useræ›´æ–°API**
- ç·¨é›†å¯èƒ½: name, avatarUrl ã®ã¿
- email, role ã¯å¤‰æ›´ä¸å¯

```
PATCH /me

Request:
{
  "name": "æ–°ã—ã„åå‰",
  "avatarUrl": "https://..."
}

Response:
{
  "data": {
    "id": "01HNK...",
    "email": "user@example.com",
    "name": "æ–°ã—ã„åå‰",
    "role": "user",
    "avatarUrl": "https://...",
    "updatedAt": "2026-01-28T10:00:00Z"
  }
}
```

---

## ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶šãƒ¡ãƒ¢ï¼ˆ2026-01-28 ã‚»ãƒƒã‚·ãƒ§ãƒ³1ï¼‰

### å‰å›ç¢ºå®šã—ãŸå†…å®¹

**4-13. ExternalShareï¼ˆå¤–éƒ¨å…±æœ‰ï¼‰**
- ç›®çš„: ãƒ¬ã‚·ãƒ”/ã‚»ãƒƒãƒˆã‚’å¤–éƒ¨ã«å…±æœ‰ï¼ˆå‘ŠçŸ¥æ‹¡æ•£ã€ãŠã™ã™ã‚ç´¹ä»‹ï¼‰
- é–²è¦§è€…ã®ãƒ­ã‚°ã‚¤ãƒ³ä¸è¦ï¼ˆã‚²ã‚¹ãƒˆOKï¼‰
- æœ‰åŠ¹æœŸé™: ç„¡æœŸé™ï¼ˆãƒ¬ã‚·ãƒ”/ã‚»ãƒƒãƒˆå‰Šé™¤ã§è‡ªå‹•ç„¡åŠ¹ï¼‰
- å‡ºå…¸åˆ¶ç´„: `authorName` ã‹ `sourceUrl` ã®ã©ã¡ã‚‰ã‹å¿…é ˆ
- å…±æœ‰URLå½¢å¼: `/share/recipe/{id}` `/share/set/{id}`

**Diagnosisï¼ˆè¨ºæ–­ï¼‰**
- **Out of scopeç¢ºå®š**ï¼ˆMVPã§ã¯å®Ÿè£…ã—ãªã„ï¼‰

---

## ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶šãƒ¡ãƒ¢ï¼ˆ2026-01-28 å‰åŠï¼‰

### å‰åŠã§ç¢ºå®šã—ãŸå†…å®¹

**4-7. CookingLog / Archive**
- åˆæœŸãƒªãƒªãƒ¼ã‚¹ã‹ã‚‰å®Ÿè£…ã™ã‚‹
- ã€Œä½œã£ãŸã€æŠ¼ä¸‹æ™‚ã«è‡ªå‹•è¨˜éŒ²ï¼ˆæ‰‹å‹•è¿½åŠ ã¯å°†æ¥ï¼‰
- å†™çœŸ/ã‚³ãƒ¡ãƒ³ãƒˆã¯å°†æ¥å¯¾å¿œ
- UIã¯ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å½¢å¼ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆã‚¤ãƒ³ã‚¹ã‚¿ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼çš„ã«ã‚¹ãƒ¯ã‚¤ãƒ—åˆ‡ã‚Šæ›¿ãˆï¼‰

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ :**
```json
{
  "id": "01HNK...",
  "userId": "01HNA...",
  "date": "2026-01-27",
  "recipeId": "01HNJ...",
  "recipeTitle": "ç”˜è¾›ãƒã‚­ãƒ³ã¨ç„¼ãé‡èœ",
  "recipeThumbnailUrl": "https://...",
  "createdAt": "2026-01-27T19:30:00Z"
}
```

**DynamoDBã‚­ãƒ¼è¨­è¨ˆ:**
```
PK: USER#<userId>
SK: LOG#<date>#<id>
```

**APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:**
- `GET /v1/archive?month=YYYY-MM` - æœˆåˆ¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‡ãƒ¼ã‚¿
- `GET /v1/archive/{date}` - æ—¥åˆ¥è©³ç´°ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ï¼‰

### æ¬¡ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã‚„ã‚‹ã“ã¨

1. APIä»•æ§˜å®šç¾©æ›¸ï¼ˆæœ€æ–°ç‰ˆï¼‰ã‚’èª­ã‚€
2. 6ç•ªï¼ˆAPIè©³ç´°ä»•æ§˜ï¼‰ã®ä½œæˆã‚’ç¶šã‘ã‚‹
3. è¨ºæ–­ï¼ˆDiagnosisï¼‰ã®æ‰±ã„ã‚’æ±ºã‚ã‚‹ï¼ˆå¤–ã™/æº–å‚™ä¸­/å®Ÿè£…ï¼‰
4. 4-9. ExternalShare ã®æ–¹é‡ç¢ºèª

### é€²æ—ã‚µãƒãƒªãƒ¼

| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | çŠ¶æ…‹ |
|-----------|------|
| 4-1ã€œ4-6 | âœ… å®Œäº† |
| 4-7. CookingLog/Archive | âœ… å®Œäº† |
| 4-8. CatalogPublish | âœ… å®Œäº†ï¼ˆç°¡ç•¥ç‰ˆï¼‰ |
| 4-9. ExternalShare | âœ… å®Œäº† |
| 4-10ã€œ4-12 | âœ… å®Œäº†ï¼ˆã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ç³»ã¯æ–¹é‡ã®ã¿ï¼‰ |
| 4-13. Notification | âœ… å®Œäº† |
| 4-15. Category | âœ… å®Œäº†ï¼ˆã‚¿ã‚°ãƒ™ãƒ¼ã‚¹å‹ï¼‰ |
| 4-16. RecipeBookEntry | âœ… å®Œäº† |
| Diagnosisï¼ˆè¨ºæ–­ï¼‰ | âŒ Out of scope |
| å…¬é–‹APIï¼ˆpublishï¼‰ | âŒ MVPå¤–ï¼ˆç›´æ¥DBæŠ•å…¥ï¼‰ |
| POST /plan/advance | âœ… å®Œäº† |
| ã‚«ãƒ†ã‚´ãƒªAPI | âœ… å®Œäº† |
| ä¿å­˜è§£é™¤API | âœ… å®Œäº† |
| Useræ›´æ–°API | âœ… å®Œäº† |
| **6. APIè©³ç´°ä»•æ§˜** | âœ… **å…¨APIå®šç¾©å®Œäº†** |

### Out of scopeï¼ˆMVPå¤–ï¼‰ã¾ã¨ã‚
- è¨ºæ–­ï¼ˆDiagnosisï¼‰API
- å…¬é–‹APIï¼ˆPOST /publish, POST /publish/stopï¼‰â†’ å…¬å¼ãƒ¬ã‚·ãƒ”ã¯ç›´æ¥DBæŠ•å…¥
- ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼/ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—API
- ãƒ•ã‚©ãƒ­ãƒ¼æ©Ÿèƒ½
