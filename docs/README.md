# kondate-loop BE開発者向け仕様書

> 最終更新: 2026-01-28

## 概要

このフォルダには、kondate-loop（献立アプリ）のバックエンド開発に必要な仕様書が含まれています。

---

## ファイル一覧

| ファイル名 | 内容 | 読む優先度 |
|-----------|------|-----------|
| `API仕様定義書_埋め込み済み.md` | **API契約（メイン）** - 全60エンドポイントの詳細仕様 | ★★★ 必読 |
| `契約凍結シート_埋め込み済み.txt` | データモデル・ロール・型定義・DB設計 | ★★★ 必読 |
| `FE追加改修リスト.md` | フロントエンド側の追加改修項目（9件） | ★★☆ 参考 |
| `2026-01-27_api-spec-wallbanger.md` | 仕様策定時の議論ログ・決定理由 | ★★☆ 参考 |

---

## 各ファイルの詳細

### 1. API仕様定義書_埋め込み済み.md
**バックエンド実装の主要参照ドキュメント**

- **6.0 共通仕様**: Base URL、認証、ヘッダー、エラーフォーマット、ページング
- **6.1 エンドポイント一覧**: 全60件のインデックス表
- **6.2 エンドポイント詳細**: 各APIの入力/出力/権限/エラー
- **6.3 Out of scope**: MVP外の機能一覧
- **6.T 共通型**: 再利用される型定義

主なエンドポイントカテゴリ:
- Auth（認証）: 4件
- User（ユーザー）: 2件
- Recipe（レシピ）: 10件
- Set（献立セット）: 10件
- Plan（献立管理）: 8件
- Shopping（買い物リスト）: 6件
- Category（カテゴリ）: 8件
- Catalog（カタログ）: 8件
- ExternalShare（外部共有）: 2件
- Purchase（課金）: 2件

### 2. 契約凍結シート_埋め込み済み.txt
**データ設計の参照ドキュメント**

- **データモデル（DynamoDB）**: PK/SK設計、GSI定義
- **ロール・権限**: user/creator/admin
- **共通型定義**: Ingredient、Instruction等のスキーマ
- **Import仕様**: JSON-LD + LLMフォールバック
- **MVP要件チェックリスト**

### 3. FE追加改修リスト.md
**フロントエンド追加改修の一覧（参考資料）**

BE実装と並行してFEで対応が必要な項目:
- **高優先度**: 外部共有ページ、カタログ保存解除、Import反映機能、通知ベースのオンボーディング
- **中優先度**: プロフィール編集、PWAインストール促進、プッシュ通知
- **低優先度**: アーカイブ詳細モーダル、カタログ未購入の表示制限

BE担当者がFE側の状況を把握するための参考資料です。

### 4. 2026-01-27_api-spec-wallbanger.md
**仕様策定の議論ログ（参考資料）**

- 各仕様決定に至った理由・背景
- 検討した代替案
- フロントエンドとの擦り合わせ内容

実装中に「なぜこの仕様なのか？」と疑問が生じた際に参照してください。

---

## 技術スタック（確定）

| 項目 | 採用技術 |
|-----|---------|
| ID生成 | ULID |
| 認証 | Cognito Hosted UI + Amplify SDK |
| DB | DynamoDB |
| 決済 | Stripe |
| LLM | Bedrock + Claude Haiku（Import用） |

---

## 実装時の注意点

1. **エラーフォーマット統一**
   - 400: 形式エラー（JSON構文など）
   - 422: バリデーションエラー（業務ルール違反）
   - error.codeは必須

2. **ページング**
   - cursor方式を採用
   - limitのデフォルトは20、最大100

3. **認証**
   - CognitoのJWTトークンを`Authorization: Bearer`で受け取る
   - `/auth/callback`でトークン発行

4. **外部共有URL**
   - ログイン不要でアクセス可能
   - `/share/recipe/{id}`形式

---

## 質問・確認事項があれば

実装中に不明点があれば、壁打ちメモを確認するか、PM（Itsuki）に確認してください。
